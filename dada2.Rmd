---
title: "Coral Reef microbiome - test reanalysis"
author: "Hadrien Gourl√©"
date: "3/6/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First we install the necessary packages

```{r install_packages}
library(dada2)
packageVersion("dada2")
```

```{r load_data}
path <- "data"
reads <- sort(list.files(path, pattern = ".fastq", full.names = TRUE))
sample.names <- sapply(strsplit(basename(reads), ".", fixed = TRUE), `[`, 1)
```

```{r qc}
plotQualityProfile(reads)
filtered_path <- file.path(path, "filtered")
filtered_reads <- file.path(filtered_path,
                            paste0(sample.names, "_filtered.fastq.gz"))
out <- filterAndTrim(reads, filtered_reads, maxN=0, maxEE=c(2,2), truncQ=2,
                     rm.phix=TRUE, compress=TRUE, multithread=TRUE,
                     maxLen = 500)
head(out)
```

